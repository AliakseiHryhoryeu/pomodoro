import{getActiveTabURL}from"./utils.js";const addNewBookmark=(e,t)=>{var a=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div");a.textContent=t.desc,a.className="bookmark-title",o.className="bookmark-controls",setBookmarkAttributes("play",onPlay,o),setBookmarkAttributes("delete",onDelete,o),r.id="bookmark-"+t.time,r.className="bookmark",r.setAttribute("timestamp",t.time),r.appendChild(a),r.appendChild(o),e.appendChild(r)},viewBookmarks=(t=[])=>{var a=document.getElementById("bookmarks");if(a.innerHTML="",0<t.length)for(let e=0;e<t.length;e++){var o=t[e];addNewBookmark(a,o)}else a.innerHTML='<i class="row">No bookmarks to show</i>'},onPlay=async e=>{var e=e.target.parentNode.parentNode.getAttribute("timestamp"),t=await getActiveTabURL();chrome.tabs.sendMessage(t.id,{type:"PLAY",value:e})},onDelete=async e=>{var t=await getActiveTabURL(),e=e.target.parentNode.parentNode.getAttribute("timestamp"),a=document.getElementById("bookmark-"+e);a.parentNode.removeChild(a),chrome.tabs.sendMessage(t.id,{type:"DELETE",value:e},viewBookmarks)},setBookmarkAttributes=(e,t,a)=>{var o=document.createElement("img");o.src="assets/"+e+".png",o.title=e,o.addEventListener("click",t),a.appendChild(o)};document.addEventListener("DOMContentLoaded",async()=>{var e=await getActiveTabURL(),t=e.url.split("?")[1];const a=new URLSearchParams(t).get("v");e.url.includes("youtube.com/watch")&&a?chrome.storage.sync.get([a],e=>{e=e[a]?JSON.parse(e[a]):[];viewBookmarks(e)}):document.getElementsByClassName("container")[0].innerHTML='<div class="title">This is not a youtube video page.</div>'});